<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ResIQ">
    <meta name="theme-color" content="#1e5a8e">
    <meta name="description" content="ResIQ - Property Management System for Vacation Rentals. Manage reservations, guest KYC, payments, and property operations.">
    <meta name="application-name" content="ResIQ">
    <meta name="msapplication-TileColor" content="#1e5a8e">
    <meta name="msapplication-TileImage" content="/assets/logo-192.png">
    <meta name="msapplication-config" content="none">
    <meta name="mobile-web-app-capable" content="yes">
    <title>ResIQ by Hostizzy - Reservation Management System</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="/assets/logo-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/assets/logo-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/assets/logo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo-192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/logo-192.png">
</head>
<body>
    
    <!-- Offline Banner -->
    <div id="offlineBanner" class="offline-banner">
        ğŸ”´ You're offline. Changes will be saved locally and synced when online.
    </div>

    <!-- Sync Indicator -->
    <div id="syncIndicator" class="sync-indicator online">
        <div class="sync-dot online"></div>
        <span id="syncStatus">Online</span>
        <span id="pendingCount" class="pending-badge" style="display: none;">0</span>
        <button id="manualSyncBtn" class="sync-button" onclick="manualSync()" style="display: none; background: none; border: none; color: inherit; cursor: pointer; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
            ğŸ”„ Sync
        </button>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="toast">
        <div class="toast-icon" id="toastIcon">ğŸ””</div>
        <div class="toast-content">
            <div class="toast-title" id="toastTitle">Notification</div>
            <div class="toast-message" id="toastMessage">Message here</div>
        </div>
        <button onclick="hideToast()" style="background: none; border: none; cursor: pointer; font-size: 18px;">Ã—</button>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="logo">
                <img src="assets/logo.png" alt="ResIQ" class="logo-img">
                <p>Property Management System</p>
            </div>
            <form onsubmit="login(); return false;">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="admin@hostizzy.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Mobile Header -->
        <div id="mobileHeader" class="mobile-header hidden">
            <div class="mobile-header-content">
                <button class="mobile-menu-btn" onclick="toggleMobileSidebar()">â˜°</button>
                <img src="assets/logo.png" alt="ResIQ" class="mobile-logo">
                <span id="mobileUserEmail" style="font-size: 12px; color: var(--text-secondary);"></span>
            </div>
        </div>

        <!-- Mobile Sidebar -->
        <div id="mobileSidebar" class="mobile-sidebar">
            <div class="mobile-sidebar-header">
                <img src="assets/logo.png" alt="ResIQ" class="mobile-logo" style="margin-bottom: 8px;">
                <div id="sidebarUserEmail" style="font-size: 13px; color: var(--text-secondary);"></div>
            </div>
            <div class="mobile-sidebar-menu">
                <a class="mobile-sidebar-link active" onclick="showViewMobile('dashboard')">
                    <span style="margin-right: 12px;">ğŸ“Š</span> Dashboard
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('reservations')">
                    <span style="margin-right: 12px;">ğŸ“…</span> Reservations
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('guestDocuments')">
                    <span style="margin-right: 12px;">ğŸ“‹</span> Documents
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('payments')">
                    <span style="margin-right: 12px;">ğŸ’°</span> Payments
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('meals')">
                    <span style="margin-right: 12px;">ğŸ½ï¸</span> Meals
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('availability')">
                    <span style="margin-right: 12px;">ğŸ—“ï¸</span> Availability
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('properties')">
                    <span style="margin-right: 12px;">ğŸ </span> Properties
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('performance')">
                    <span style="margin-right: 12px;">ğŸ“Š</span> Performance
                </a>
                <a class="mobile-sidebar-link" onclick="showViewMobile('team')">
                    <span style="margin-right: 12px;">ğŸ‘¥</span> Team
                </a>
                <a class="mobile-sidebar-link" onclick="logout()" style="margin-top: 20px; color: var(--danger);">
                    <span style="margin-right: 12px;">ğŸšª</span> Logout
                </a>
            </div>
        </div>

        <!-- Mobile Overlay -->
        <div id="mobileOverlay" class="mobile-overlay" onclick="toggleMobileSidebar()"></div>

        <!-- Pull to Refresh Indicator -->
        <div class="pull-to-refresh-indicator" id="pullToRefreshIndicator">
            <div class="pull-to-refresh-arrow" id="pullToRefreshArrow">â¬‡ï¸</div>
        </div>

        <!-- Desktop/Tablet Top Navigation Bar -->
        <nav class="navbar">
            <div class="navbar-content">
                <!-- Logo + Home (clickable) -->
                <div class="navbar-brand" onclick="showView('home')" style="cursor: pointer;">
                    <img src="assets/logo-132.png" alt="ResIQ" class="navbar-logo">
                </div>

                <!-- Spacer -->
                <div style="flex: 1;"></div>

                <!-- Dark Mode Toggle -->
                <button class="theme-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode (CMD+SHIFT+D)" style="margin-right: 12px;">
                    <span id="themeIcon">â˜€ï¸</span>
                </button>

                <!-- Color Theme Selector -->
                <button class="theme-toggle" onclick="openThemeSelector()" title="Change Color Theme" style="margin-right: 16px;">
                    <span>ğŸ¨</span>
                </button>

                <!-- Profile Dropdown (Desktop & Tablet) -->
                <div class="navbar-menu">
                    <div class="user-menu-container">
                        <button class="user-menu-btn" onclick="toggleUserMenu()">
                            <span class="user-icon">ğŸ‘¤</span>
                            <span id="userEmail" class="user-email">Account</span>
                            <span class="user-menu-arrow">â–¼</span>
                        </button>
                        <div class="user-menu-dropdown" id="userMenuDropdown">
                            <div class="user-menu-header">
                                <div class="user-menu-email" id="userEmailDropdown">user@hostizzy.com</div>
                                <div class="user-menu-status">
                                    <span class="online-indicator"></span> Online
                                </div>
                            </div>
                            <div class="user-menu-divider"></div>
                            <a class="user-menu-item" onclick="logout()">
                                <span class="user-menu-icon">ğŸšª</span>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Desktop Sidebar -->
        <aside class="sidebar">
            <!-- Main Navigation Menu -->
            <div class="sidebar-menu">
                <div class="sidebar-title">Navigation</div>
                
                <!-- Dashboard -->
                <a class="sidebar-item active" onclick="showView('dashboard')">
                    <span class="sidebar-item-icon">ğŸ“Š</span>
                    <span class="sidebar-item-label">Dashboard</span>
                </a>

                <!-- Reservations -->
                <a class="sidebar-item" onclick="showView('reservations')">
                    <span class="sidebar-item-icon">ğŸ“…</span>
                    <span class="sidebar-item-label">Reservations</span>
                </a>

                <!-- Guests -->
                <a class="sidebar-item" onclick="showView('guests')">
                    <span class="sidebar-item-icon">ğŸ‘¥</span>
                    <span class="sidebar-item-label">Guests</span>
                </a>

                <!-- Payments -->
                <a class="sidebar-item" onclick="showView('payments')">
                    <span class="sidebar-item-icon">ğŸ’°</span>
                    <span class="sidebar-item-label">Payments</span>
                </a>

                <!-- Meals -->
                <a class="sidebar-item" onclick="showView('meals')">
                    <span class="sidebar-item-icon">ğŸ½ï¸</span>
                    <span class="sidebar-item-label">Meals</span>
                </a>

                <!-- Properties -->
                <a class="sidebar-item" onclick="showView('properties')">
                    <span class="sidebar-item-icon">ğŸ˜ï¸</span>
                    <span class="sidebar-item-label">Properties</span>
                </a>

                <!-- Documents -->
                <a class="sidebar-item" onclick="showView('guestDocuments')">
                    <span class="sidebar-item-icon">ğŸ“„</span>
                    <span class="sidebar-item-label">Documents</span>
                </a>

                <!-- Performance -->
                <a class="sidebar-item" onclick="showView('performance')">
                    <span class="sidebar-item-icon">ğŸ“ˆ</span>
                    <span class="sidebar-item-label">Analytics</span>
                </a>

                <!-- Availability -->
                <a class="sidebar-item" onclick="showView('availability')">
                    <span class="sidebar-item-icon">ğŸ“†</span>
                    <span class="sidebar-item-label">Availability</span>
                </a>

                <!-- Team -->
                <a class="sidebar-item" onclick="showView('team')">
                    <span class="sidebar-item-icon">ğŸ‘¨â€ğŸ’¼</span>
                    <span class="sidebar-item-label">Team</span>
                </a>
            </div>

            <!-- Sidebar Footer (Settings & Support) -->
            <div class="sidebar-footer">
                <div class="sidebar-title" style="padding: 0 16px;">More</div>
                
                <!-- Settings -->
                <a class="sidebar-item" onclick="showView('settings')">
                    <span class="sidebar-item-icon">âš™ï¸</span>
                    <span class="sidebar-item-label">Settings</span>
                </a>

                <!-- Logout -->
                <a class="sidebar-item" onclick="logout()">
                    <span class="sidebar-item-icon">ğŸšª</span>
                    <span class="sidebar-item-label">Logout</span>
                </a>
            </div>
        </aside>

        <!-- Mobile Top Header -->
        <div class="mobile-header">
            <div class="mobile-header-content">
                <!-- Hamburger Menu Button -->
                <button class="mobile-menu-btn" onclick="toggleMobileSidebar()">
                    <span id="hamburgerIcon">â˜°</span>
                </button>

                <!-- Logo (Center) -->
                <div class="mobile-header-logo" onclick="showView('home')" style="cursor: pointer;">
                    ğŸ  ResIQ
                </div>

                <!-- Profile Button -->
                <button class="mobile-menu-btn" onclick="toggleUserMenuMobile()">ğŸ‘¤</button>
            </div>
        </div>

        <!-- Mobile Sidebar (Hamburger Menu) -->
        <aside class="mobile-sidebar" id="mobileSidebar">
            <div class="mobile-sidebar-header">
                â˜° Menu
            </div>

            <div class="mobile-sidebar-menu">
                <!-- Dashboard -->
                <a class="mobile-sidebar-link active" onclick="showView('dashboard'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ“Š</span>
                    <span class="mobile-sidebar-text">Dashboard</span>
                </a>

                <!-- Reservations -->
                <a class="mobile-sidebar-link" onclick="showView('reservations'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ“…</span>
                    <span class="mobile-sidebar-text">Reservations</span>
                </a>

                <!-- Guests -->
                <a class="mobile-sidebar-link" onclick="showView('guests'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ‘¥</span>
                    <span class="mobile-sidebar-text">Guests</span>
                </a>

                <!-- Payments -->
                <a class="mobile-sidebar-link" onclick="showView('payments'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ’°</span>
                    <span class="mobile-sidebar-text">Payments</span>
                </a>

                <!-- Meals -->
                <a class="mobile-sidebar-link" onclick="showView('meals'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ½ï¸</span>
                    <span class="mobile-sidebar-text">Meals</span>
                </a>

                <!-- Properties -->
                <a class="mobile-sidebar-link" onclick="showView('properties'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ˜ï¸</span>
                    <span class="mobile-sidebar-text">Properties</span>
                </a>

                <!-- Documents -->
                <a class="mobile-sidebar-link" onclick="showView('guestDocuments'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ“„</span>
                    <span class="mobile-sidebar-text">Documents</span>
                </a>

                <!-- Analytics -->
                <a class="mobile-sidebar-link" onclick="showView('performance'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ“ˆ</span>
                    <span class="mobile-sidebar-text">Analytics</span>
                </a>

                <!-- Availability -->
                <a class="mobile-sidebar-link" onclick="showView('availability'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ“†</span>
                    <span class="mobile-sidebar-text">Availability</span>
                </a>

                <!-- Team -->
                <a class="mobile-sidebar-link" onclick="showView('team'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">ğŸ‘¨â€ğŸ’¼</span>
                    <span class="mobile-sidebar-text">Team</span>
                </a>
            </div>

            <div class="mobile-sidebar-footer">
                <!-- Settings -->
                <a class="mobile-sidebar-link" onclick="showView('settings'); closeMobileSidebar();">
                    <span class="mobile-sidebar-icon">âš™ï¸</span>
                    <span class="mobile-sidebar-text">Settings</span>
                </a>

                <!-- Logout -->
                <a class="mobile-sidebar-link" onclick="logout();">
                    <span class="mobile-sidebar-icon">ğŸšª</span>
                    <span class="mobile-sidebar-text">Logout</span>
                </a>
            </div>
        </aside>

        <!-- Mobile Overlay (for sidebar backdrop) -->
        <div class="mobile-overlay" id="mobileOverlay" onclick="closeMobileSidebar()"></div>

        <!-- Mobile Bottom Navigation -->
        <div class="mobile-nav hidden">
            <div class="mobile-nav-items">
                <a class="mobile-nav-item" onclick="showView('home')">
                    <div class="mobile-nav-icon">ğŸ </div>
                    <div>Home</div>
                </a>
                <a class="mobile-nav-item" onclick="showView('reservations')">
                    <div class="mobile-nav-icon">ğŸ“…</div>
                    <div>Bookings</div>
                </a>
                <a class="mobile-nav-item" onclick="showView('guests')">
                    <div class="mobile-nav-icon">ğŸ‘¥</div>
                    <div>Guests</div>
                </a>
                <a class="mobile-nav-item" onclick="showView('meals')">
                    <div class="mobile-nav-icon">ğŸ½ï¸</div>
                    <div>Meals</div>
                </a>
                <a class="mobile-nav-item" onclick="showView('payments')">
                    <div class="mobile-nav-icon">ğŸ’°</div>
                    <div>Payments</div>
                </a>
                <a class="mobile-nav-item" onclick="showView('performance')">
                    <div class="mobile-nav-icon">ğŸ“ˆ</div>
                    <div>Performance</div>
                </a>
            </div>
        </div>

        <!-- Home Screen / Icon Dashboard -->
        <div id="homeView" class="container hidden">
            <!-- âœ¨ Premium Welcome Header -->
            <div class="card-premium-glass animate-fade-in-down" style="
                background: var(--gradient-primary);
                border-radius: var(--radius-2xl);
                padding: var(--space-10);
                margin-bottom: var(--space-8);
                color: white;
                position: relative;
                overflow: hidden;
                border: 1px solid rgba(255,255,255,0.2);
            ">
                <div style="position: relative; z-index: 1;">
                    <div style="font-size: var(--text-sm); opacity: 0.9; margin-bottom: var(--space-2); font-weight: var(--font-weight-medium);" id="greetingTime">Good Morning</div>
                    <h1 class="animate-fade-in-up" style="font-size: var(--text-4xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-1);" id="greetingUser">Welcome Back!</h1>
                    <p style="opacity: 0.9; font-size: var(--text-base);">Here's your business overview for today</p>
                </div>
                <div class="animate-float" style="
                    position: absolute;
                    right: var(--space-8);
                    bottom: var(--space-4);
                    font-size: 8rem;
                    opacity: 0.15;
                ">ğŸ‘‹</div>
            </div>

            <!-- Quick Stats Cards Grid -->
            <div style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 16px;
                margin-bottom: 32px;
            ">
                <!-- Dashboard Card -->
                <div class="icon-card" onclick="showView('dashboard')" style="animation: cardPop 0.5s ease-out 0.1s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        ğŸ“Š
                    </div>
                    <div class="icon-card-title">Dashboard</div>
                    <div class="icon-card-stat" id="homeStatReservations">--</div>
                    <div class="icon-card-label">Total Bookings</div>
                </div>

                <!-- Reservations Card -->
                <div class="icon-card" onclick="showView('reservations')" style="animation: cardPop 0.5s ease-out 0.2s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        ğŸ“…
                    </div>
                    <div class="icon-card-title">Reservations</div>
                    <div class="icon-card-stat" id="homeStatActive">--</div>
                    <div class="icon-card-label">Active Now</div>
                </div>

                <!-- Payments Card -->
                <div class="icon-card" onclick="showView('payments')" style="animation: cardPop 0.5s ease-out 0.3s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                        ğŸ’°
                    </div>
                    <div class="icon-card-title">Payments</div>
                    <div class="icon-card-stat" id="homeStatPending">--</div>
                    <div class="icon-card-label">Pending</div>
                </div>

                <!-- Availability Card -->
                <div class="icon-card" onclick="showView('availability')" style="animation: cardPop 0.5s ease-out 0.4s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                        ğŸ—“ï¸
                    </div>
                    <div class="icon-card-title">Availability</div>
                    <div class="icon-card-stat" id="homeStatUpcoming">--</div>
                    <div class="icon-card-label">Upcoming</div>
                </div>

                <!-- Properties Card -->
                <div class="icon-card" onclick="showView('properties')" style="animation: cardPop 0.5s ease-out 0.5s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                        ğŸ 
                    </div>
                    <div class="icon-card-title">Properties</div>
                    <div class="icon-card-stat" id="homeStatProperties">--</div>
                    <div class="icon-card-label">Total Properties</div>
                </div>

                <!-- Guests Card -->
                <div class="icon-card" onclick="showView('guests')" style="animation: cardPop 0.5s ease-out 0.6s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
                        ğŸ‘¥
                    </div>
                    <div class="icon-card-title">Guests</div>
                    <div class="icon-card-stat" id="homeStatGuests">--</div>
                    <div class="icon-card-label">Total Guests</div>
                </div>

                <!-- Performance Card -->
                <div class="icon-card" onclick="showView('performance')" style="animation: cardPop 0.5s ease-out 0.7s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                        ğŸ“ˆ
                    </div>
                    <div class="icon-card-title">Performance</div>
                    <div class="icon-card-stat" id="homeStatRevenue">--</div>
                    <div class="icon-card-label">This Month</div>
                </div>

                <!-- Guest Documents Card -->
                <div class="icon-card" onclick="showView('guestDocuments')" style="animation: cardPop 0.5s ease-out 0.8s both;">
                    <div class="icon-card-icon" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                        ğŸ“‹
                    </div>
                    <div class="icon-card-title">Documents</div>
                    <div class="icon-card-stat" id="homeStatDocuments">--</div>
                    <div class="icon-card-label">Pending Review</div>
                </div>
            </div>

            <!-- âœ¨ Premium Quick Actions -->
            <div class="card-premium animate-fade-in-up" style="margin-bottom: var(--space-8);">
                <div class="widget-header">
                    <h3 class="widget-title">âš¡ Quick Actions</h3>
                </div>
                <div style="padding: var(--space-6); display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-3);">
                    <button class="btn-premium btn-premium-primary hover-lift" onclick="openReservationModal()">
                        â• New Booking
                    </button>
                    <button class="btn-premium btn-premium-success hover-lift" onclick="openMultiPaymentModal()">
                        ğŸ’° Add Payments
                    </button>
                    <button class="btn-premium btn-premium-outline hover-lift" onclick="openPropertyModal()">
                        ğŸ  Add Property
                    </button>
                </div>
            </div>

            <!-- âœ¨ Premium Recent Activity -->
            <div class="card-premium animate-fade-in-up animate-delay-1">
                <div class="widget-header">
                    <h3 class="widget-title">ğŸ• Recent Activity</h3>
                </div>
                <div id="recentActivityList" class="widget-body" style="font-size: var(--text-sm); color: var(--neutral-500);">
                    Loading activity...
                </div>
            </div>
        </div>

        <style>
        .icon-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .icon-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .icon-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }

        .icon-card:hover::before {
            opacity: 1;
        }

        .icon-card-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .icon-card-title {
            font-size: 14px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .icon-card-stat {
            font-size: 28px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .icon-card-label {
            font-size: 12px;
            color: #64748b;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .icon-card {
                padding: 20px 16px;
            }
            
            .icon-card-icon {
                width: 56px;
                height: 56px;
                font-size: 28px;
            }
            
            .icon-card-stat {
                font-size: 24px;
            }
        }
        </style>

        <!-- Dashboard View -->
        <div id="dashboardView" class="container">
            <!-- âœ¨ Premium Header -->
            <div class="page-header animate-fade-in-down">
                <div>
                    <h2 class="page-title">Dashboard</h2>
                    <p class="page-subtitle">Real-time overview of your property management</p>
                </div>
                <div class="page-actions">
                    <button class="btn-premium btn-premium-outline btn-premium-sm" onclick="toggleAdvancedFilters()">
                        âš™ï¸ Filters
                    </button>
                    <button class="btn-premium btn-premium-primary" onclick="openReservationModal()">
                        â• New Booking
                    </button>
                </div>
            </div>

            <!-- âœ¨ Quick Filter Chips (Premium Style) -->
            <div class="flex gap-2 animate-fade-in-up" style="margin-bottom: 24px; flex-wrap: wrap; overflow-x: auto; padding-bottom: 8px;">
                <button class="btn-premium btn-premium-sm btn-premium-primary" data-filter="all" onclick="applyQuickFilter('all')">
                    ğŸ“Š All Data
                </button>
                <button class="btn-premium btn-premium-sm btn-premium-outline" data-filter="next-7-days" onclick="applyQuickFilter('next-7-days')">
                    ğŸ“… Next 7 Days
                </button>
                <button class="btn-premium btn-premium-sm btn-premium-outline" data-filter="today" onclick="applyQuickFilter('today')">
                    ğŸ  Today
                </button>
                <button class="btn-premium btn-premium-sm btn-premium-outline" data-filter="payment-due" onclick="applyQuickFilter('payment-due')">
                    ğŸ’° Payment Due
                </button>
                <button class="btn-premium btn-premium-sm btn-premium-outline" data-filter="this-month" onclick="applyQuickFilter('this-month')">
                    ğŸ“† This Month
                </button>
                <button class="btn-premium btn-premium-sm btn-premium-outline" data-filter="needs-attention" onclick="applyQuickFilter('needs-attention')">
                    âš ï¸ Needs Attention
                </button>
            </div>

            <!-- âœ¨ Premium Primary Stats -->
            <div class="stats-grid animate-fade-in-up animate-delay-1" style="margin-bottom: 32px;">
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-primary);">
                    <div class="stat-card-icon">ğŸ“Š</div>
                    <div class="stat-card-value" id="totalReservations">0</div>
                    <div class="stat-card-label">Total Reservations</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-success);">
                    <div class="stat-card-icon">ğŸ </div>
                    <div class="stat-card-value" id="activeReservations">0</div>
                    <div class="stat-card-label">Active Bookings</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-ocean);">
                    <div class="stat-card-icon">ğŸ“…</div>
                    <div class="stat-card-value" id="upcomingReservations">0</div>
                    <div class="stat-card-label">Upcoming Bookings</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-purple);">
                    <div class="stat-card-icon">ğŸ‰</div>
                    <div class="stat-card-value" id="completedReservations">0</div>
                    <div class="stat-card-label">Completed Bookings</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-warning);">
                    <div class="stat-card-icon">ğŸ’°</div>
                    <div class="stat-card-value">â‚¹<span id="avgBookingValue">0</span></div>
                    <div class="stat-card-label">Avg Booking Value</div>
                </div>
            </div>

            <!-- âœ¨ This Month Performance Card (Premium) -->
            <div class="card-premium animate-fade-in-up animate-delay-2" style="margin-bottom: 24px; background: var(--gradient-primary); color: white; border: none;">
                <div style="padding: 24px; border-bottom: 1px solid rgba(255,255,255,0.2);">
                    <div class="flex justify-between items-center" style="flex-wrap: wrap; gap: 12px;">
                        <h3 style="color: white; margin: 0; font-size: var(--text-2xl); font-weight: var(--font-weight-bold);">ğŸ“Š This Month Performance</h3>
                        <div style="font-size: 14px; opacity: 0.9; font-weight: 500;" id="currentMonthLabel">January 2025</div>
                    </div>
                </div>
                <div class="grid-cols-1 md:grid-cols-3" style="display: grid; gap: 20px; padding: 24px;">
                    <!-- Nights Card -->
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: var(--radius-xl);">
                        <div style="font-size: 2rem; margin-bottom: 8px;">ğŸ—“ï¸</div>
                        <div style="font-size: var(--text-3xl); font-weight: var(--font-weight-bold); margin-bottom: 4px;" id="monthNights">0</div>
                        <div style="font-size: var(--text-sm); opacity: 0.9; margin-bottom: 8px;">Total Nights</div>
                        <div class="flex items-center gap-1" style="font-size: var(--text-sm);" id="monthNightsChange">
                            <span>â†’</span> <span>0%</span>
                        </div>
                    </div>

                    <!-- Revenue Card -->
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: var(--radius-xl);">
                        <div style="font-size: 2rem; margin-bottom: 8px;">ğŸ’°</div>
                        <div style="font-size: var(--text-3xl); font-weight: var(--font-weight-bold); margin-bottom: 4px;" id="monthRevenue">â‚¹0</div>
                        <div style="font-size: var(--text-sm); opacity: 0.9; margin-bottom: 8px;">Total Revenue</div>
                        <div class="flex items-center gap-1" style="font-size: var(--text-sm);" id="monthRevenueChange">
                            <span>â†’</span> <span>0%</span>
                        </div>
                    </div>

                    <!-- Hostizzy Revenue Card -->
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: var(--radius-xl);">
                        <div style="font-size: 2rem; margin-bottom: 8px;">ğŸ¢</div>
                        <div style="font-size: var(--text-3xl); font-weight: var(--font-weight-bold); margin-bottom: 4px;" id="monthHostizzyRevenue">â‚¹0</div>
                        <div style="font-size: var(--text-sm); opacity: 0.9; margin-bottom: 8px;">Hostizzy Revenue</div>
                        <div class="flex items-center gap-1" style="font-size: var(--text-sm);" id="monthHostizzyChange">
                            <span>â†’</span> <span>0%</span>
                        </div>
                    </div>
                </div>
                <div style="padding: 12px 24px; background: rgba(0,0,0,0.2); font-size: 13px; opacity: 0.9; border-top: 1px solid rgba(255,255,255,0.1);">
                    ğŸ’¡ Comparison with last month
                </div>
            </div>

            <!-- âœ¨ Revenue Forecast Widget (PREMIUM FEATURE) -->
            <div id="revenueForecast" class="animate-fade-in-up animate-delay-3" style="margin-bottom: 24px;">
                <!-- Forecast widget will be rendered here by JavaScript -->
            </div>

            <!-- Enhanced Metrics -->
            <div id="enhancedMetrics" class="animate-fade-in-up animate-delay-4" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 24px;">
                <!-- Will be populated by JavaScript -->
            </div>

            <!-- Payment Analytics & Revenue Split -->
            <div class="grid-cols-1 md:grid-cols-2 animate-fade-in-up animate-delay-5" style="display: grid; gap: 20px; margin-bottom: 24px;">
                <!-- Revenue Distribution -->
                <div class="card-premium">
                    <div class="widget-header">
                        <h3 class="widget-title">ğŸ’° Revenue Distribution</h3>
                    </div>
                    <div style="padding: 20px; display: grid; gap: 16px;">
                        <div style="padding: 16px; background: rgba(99, 102, 241, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: var(--text-2xl); font-weight: var(--font-weight-bold); color: var(--brand-primary); margin-bottom: 4px;" id="hostizzyTotal">â‚¹0</div>
                            <div style="font-size: var(--text-sm); color: var(--neutral-600); margin-bottom: 8px;">ğŸ¢ Hostizzy Revenue</div>
                            <div style="font-size: var(--text-xs); color: var(--neutral-500);" id="hostizzyPercentage">0%</div>
                        </div>
                        <div style="padding: 16px; background: rgba(16, 185, 129, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: var(--text-2xl); font-weight: var(--font-weight-bold); color: var(--color-success); margin-bottom: 4px;" id="ownerTotal">â‚¹0</div>
                            <div style="font-size: var(--text-sm); color: var(--neutral-600); margin-bottom: 8px;">ğŸ  Owner Revenue</div>
                            <div style="font-size: var(--text-xs); color: var(--neutral-500);" id="ownerPercentage">0%</div>
                        </div>
                    </div>
                </div>

                <!-- Payment Collection Status -->
                <div class="card-premium">
                    <div class="widget-header">
                        <h3 class="widget-title">ğŸ’³ Payment Collection</h3>
                    </div>
                    <div style="padding: 20px; display: grid; gap: 16px;">
                        <div style="padding: 16px; background: rgba(16, 185, 129, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: var(--text-2xl); font-weight: var(--font-weight-bold); color: var(--color-success); margin-bottom: 4px;" id="totalCollected">â‚¹0</div>
                            <div style="font-size: var(--text-sm); color: var(--neutral-600); margin-bottom: 8px;">âœ… Collected</div>
                            <div style="font-size: var(--text-xs); color: var(--neutral-500);" id="collectionRate">0%</div>
                        </div>
                        <div style="padding: 16px; background: rgba(239, 68, 68, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: var(--text-2xl); font-weight: var(--font-weight-bold); color: var(--color-error); margin-bottom: 4px;" id="pendingCollection">â‚¹0</div>
                            <div style="font-size: var(--text-sm); color: var(--neutral-600); margin-bottom: 8px;">â³ Pending</div>
                            <div style="font-size: var(--text-xs); color: var(--neutral-500);" id="pendingRate">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Center -->
            <div class="card" id="actionCenterCard" style="display: none;">
                <div class="card-header" style="cursor:pointer" onclick="toggleCollapse('actionCenterContent','actionCenterIcon')">
                    <h3 class="card-title">
                        âš¡ Action Center 
                        <span id="actionCenterTotalBadge" style="background: var(--danger); color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">0</span>
                        <span id="actionCenterIcon">ğŸ”½</span>
                    </h3>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <label style="font-size: 12px; color: var(--text-secondary); display: flex; align-items: center; gap: 4px; margin: 0;">
                            <input type="checkbox" id="actionCenterShowAll" onchange="toggleActionCenterRange()" style="width: auto; margin: 0;">
                            Show all history
                        </label>
                    </div>
                </div>

                <!-- NEW WRAPPER that gets collapsed -->
                <div id="actionCenterContent">
                    <div id="actionCenterBody">
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <button class="btn btn-sm" id="urgentTab" onclick="switchActionTab('urgent')" style="background: var(--danger); color: white;">
                        ğŸ”´ Urgent (<span id="urgentCount">0</span>)
                        </button>
                        <button class="btn btn-sm" id="todayTab" onclick="switchActionTab('today')" style="background: var(--warning); color: white;">
                        ğŸŸ¡ Today (<span id="todayCount">0</span>)
                        </button>
                        <button class="btn btn-sm" id="upcomingTab" onclick="switchActionTab('upcoming')" style="background: var(--success); color: white;">
                        ğŸŸ¢ Upcoming (<span id="upcomingCount">0</span>)
                        </button>
                    </div>
                    </div>

                    <!-- Urgent / Today / Upcoming lists stay the same -->
                    <div id="urgentActions" class="action-tab-content">
                        <div class="action-section-header" onclick="toggleOverdueActions(event)" style="cursor: pointer; padding: 12px; background: #fef2f2; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="font-weight: 600; color: var(--danger);">ğŸš¨ Overdue & Urgent</span>
                                <span id="urgentBadge" style="background: var(--danger); color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-left: 8px;">0</span>
                            </div>
                            <span id="overdueToggleIcon">ğŸ”½</span>
                        </div>
                        <div id="urgentActionsList"></div>
                    </div>

                    <div id="todayActions" class="action-tab-content" style="display: none;">
                    <div id="todayActionsList"></div>
                    </div>

                    <div id="upcomingActions" class="action-tab-content" style="display: none;">
                    <div id="upcomingActionsList"></div>
                    </div>
                </div>
                </div>

            <!-- AI-Powered Insights Section -->
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; margin-bottom: 24px;">
                <div class="card-header" style="border-bottom: 1px solid rgba(255,255,255,0.2); cursor: pointer;" onclick="toggleCollapse('aiInsightsContent','aiInsightsIcon')">
                    <h3 class="card-title" style="color: white; display: flex; align-items: center; gap: 8px;">
                        ğŸ¤– AI-Powered Insights <span style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 10px;">SMART</span>
                        <span id="aiInsightsIcon">ğŸ”½</span>
                    </h3>
                    <div style="font-size: 13px; opacity: 0.9;">Intelligent recommendations for your business</div>
                </div>
                <div id="aiInsightsContent">
                    <div id="aiInsightsContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; padding: 20px;">
                        <!-- AI insights will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Top 15 Properties Performance -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ† Top 15 Properties Performance</h3>
                    <button class="btn btn-primary btn-sm" onclick="showView('properties')">View All Properties</button>
                </div>
                <div style="padding: 20px;">
                    <div style="margin-bottom: 16px; display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="btn btn-sm" id="sortByRevenue" onclick="sortPropertiesBy('revenue')" style="background: var(--primary); color: white;">
                            ğŸ’° By Revenue
                        </button>
                        <button class="btn btn-sm" id="sortByBookings" onclick="sortPropertiesBy('bookings')" style="background: var(--secondary); color: white;">
                            ğŸ“Š By Bookings
                        </button>
                        <button class="btn btn-sm" id="sortByNights" onclick="sortPropertiesBy('nights')" style="background: var(--secondary); color: white;">
                            ğŸŒ™ By Nights
                        </button>
                        <button class="btn btn-sm" id="sortByGuests" onclick="sortPropertiesBy('guests')" style="background: var(--secondary); color: white;">
                            ğŸ‘¥ By Guests
                        </button>
                        <button class="btn btn-sm" id="sortByOccupancy" onclick="sortPropertiesBy('occupancy')" style="background: var(--secondary); color: white;">
                            ğŸ“ˆ By Occupancy
                        </button>
                    </div>
                    <div id="topPropertiesStats">
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Loading property statistics...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Guests View -->
        <div id="guestsView" class="container hidden">
            <!-- âœ¨ Premium Header -->
            <div class="page-header animate-fade-in-down">
                <div>
                    <h2 class="page-title">ğŸ‘¥ Guest Directory</h2>
                    <p class="page-subtitle">Manage your guest relationships and history</p>
                </div>
                <div class="page-actions">
                    <button class="btn-premium btn-premium-outline btn-premium-sm" onclick="exportGuestsCSV()">
                        ğŸ“¥ Export CSV
                    </button>
                </div>
            </div>

            <!-- âœ¨ Premium Guest Statistics -->
            <div class="stats-grid animate-fade-in-up" style="margin-bottom: var(--space-6);">
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-primary);">
                    <div class="stat-card-icon">ğŸ‘¥</div>
                    <div class="stat-card-value" id="guestStatTotal">0</div>
                    <div class="stat-card-label">Total Guests</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-success);">
                    <div class="stat-card-icon">ğŸŒŸ</div>
                    <div class="stat-card-value" id="guestStatRepeat">0</div>
                    <div class="stat-card-label">Repeat Guests</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-warning);">
                    <div class="stat-card-icon">ğŸ‘‘</div>
                    <div class="stat-card-value" id="guestStatVIP">0</div>
                    <div class="stat-card-label">VIP (5+ Stays)</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-purple);">
                    <div class="stat-card-icon">ğŸ’</div>
                    <div class="stat-card-value" id="guestStatHighValue">0</div>
                    <div class="stat-card-label">High Value (â‚¹50K+)</div>
                </div>
                <div class="stat-card-premium hover-lift" style="background: var(--gradient-ocean);">
                    <div class="stat-card-icon">ğŸ“Š</div>
                    <div class="stat-card-value" id="guestStatAvgStays">0</div>
                    <div class="stat-card-label">Avg Stays/Guest</div>
                </div>
            </div>

            <!-- âœ¨ Premium Search & Filters Card -->
            <div class="card-premium animate-fade-in-up animate-delay-1">
                <div class="widget-header">
                    <h3 class="widget-title">Guest List</h3>
                </div>

                <!-- Premium Filters -->
                <div style="padding: var(--space-4); border-bottom: 1px solid var(--neutral-200); display: flex; gap: var(--space-3); flex-wrap: wrap; align-items: center;">
                    <div class="search-premium" style="flex: 1; min-width: 280px;">
                        <span class="search-premium-icon">ğŸ”</span>
                        <input type="text" id="searchGuests" class="search-premium-input" placeholder="Search by name, phone, or email..." onkeyup="searchGuests()">
                    </div>

                    <div class="btn-group">
                        <button class="btn-premium btn-premium-sm btn-premium-primary" id="tableViewBtn" onclick="switchGuestView('table')">
                            ğŸ“Š Table
                        </button>
                        <button class="btn-premium btn-premium-sm btn-premium-outline" id="cardViewBtn" onclick="switchGuestView('cards')">
                            ğŸ´ Cards
                        </button>
                    </div>

                    <div class="select-premium" style="min-width: 180px;">
                        <select id="guestTypeFilter" onchange="filterGuests()" style="width: 100%; padding: var(--space-2) var(--space-3); border: 2px solid var(--neutral-300); border-radius: var(--radius-lg); font-size: var(--text-sm);">
                            <option value="">All Guests</option>
                            <option value="repeat">ğŸŒŸ Repeat Guests</option>
                            <option value="new">âœ¨ New Guests</option>
                            <option value="vip">ğŸ‘‘ VIP (5+ Stays)</option>
                            <option value="highvalue">ğŸ’ High Value (â‚¹50K+)</option>
                        </select>
                    </div>

                    <div class="select-premium" style="min-width: 120px;">
                        <select id="guestsPerPage" onchange="changeGuestsPerPage()" style="width: 100%; padding: var(--space-2) var(--space-3); border: 2px solid var(--neutral-300); border-radius: var(--radius-lg); font-size: var(--text-sm);">
                            <option value="25">Show 25</option>
                            <option value="50" selected>Show 50</option>
                            <option value="100">Show 100</option>
                            <option value="all">Show All</option>
                        </select>
                    </div>

                    <button class="btn-premium btn-premium-ghost btn-premium-sm" onclick="clearGuestFilters()">Clear</button>
                </div>

                <!-- Table View Container -->
                <div id="guestTableView" style="display: block;">
                    <div class="table-container">
                        <table class="table-premium">
                            <thead>
                                <tr>
                                    <th onclick="sortGuestsTable('name')" style="cursor: pointer;">
                                        Guest Name <span id="sortIconName">â†•ï¸</span>
                                    </th>
                                    <th onclick="sortGuestsTable('phone')" style="cursor: pointer;">
                                        Contact <span id="sortIconPhone">â†•ï¸</span>
                                    </th>
                                    <th onclick="sortGuestsTable('lastVisit')" style="cursor: pointer;">
                                        Last Visit <span id="sortIconLastVisit">â†•ï¸</span>
                                    </th>
                                    <th onclick="sortGuestsTable('stays')" style="cursor: pointer;">
                                        Stays <span id="sortIconStays">â†•ï¸</span>
                                    </th>
                                    <th onclick="sortGuestsTable('spent')" style="cursor: pointer;">
                                        Total Spent <span id="sortIconSpent">â†•ï¸</span>
                                    </th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="guestTableBody">
                                <tr><td colspan="6" class="text-center" style="padding: var(--space-8);">
                                    <div class="empty-state-premium">
                                        <div class="empty-state-icon">ğŸ‘¥</div>
                                        <div class="empty-state-title">Loading guests...</div>
                                    </div>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination -->
                    <div id="guestPagination" style="display: flex; justify-content: space-between; align-items: center; padding: 16px; border-top: 1px solid var(--border);">
                        <div style="font-size: 14px; color: var(--text-secondary);">
                            Showing <span id="guestShowingStart">0</span>-<span id="guestShowingEnd">0</span> of <span id="guestShowingTotal">0</span> guests
                        </div>
                        <div style="display: flex; gap: 8px;" id="guestPaginationButtons">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Card View Container -->
                <div id="guestCardView" style="display: none; padding: 20px;">
                    <div id="guestListContainer">
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Loading guests...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reservations View -->
        <div id="reservationsView" class="container hidden">
            <!-- âœ¨ Premium Header with Search & Actions -->
            <div class="page-header animate-fade-in-down">
                <div>
                    <h2 class="page-title">Reservations</h2>
                    <p class="page-subtitle">Manage all your property bookings</p>
                </div>
                <div class="page-actions">
                    <div class="search-premium">
                        <span class="search-premium-icon">ğŸ”</span>
                        <input type="text" id="smartSearch" class="search-premium-input" placeholder="Search by name, email, booking ID...">
                    </div>
                    <button class="btn-premium btn-premium-outline btn-premium-sm" onclick="toggleAdvancedFilters()">
                        âš™ï¸ Filters
                    </button>
                    <button class="btn-premium btn-premium-primary" onclick="openReservationModal()">
                        â• New Booking
                    </button>
                </div>
            </div>

            <!-- âœ¨ View Toggle - Kanban | Calendar | List -->
            <div class="flex justify-between items-center" style="margin-bottom: 24px; flex-wrap: wrap; gap: 12px;">
                <div class="btn-group">
                    <button class="btn-premium btn-premium-sm btn-premium-primary" id="kanbanViewBtn" onclick="switchReservationView('kanban')" style="border-radius: 8px 0 0 8px;">
                        ğŸ¯ Kanban
                    </button>
                    <button class="btn-premium btn-premium-sm btn-premium-outline" id="calendarViewBtn" onclick="switchReservationView('calendar')" style="border-radius: 0;">
                        ğŸ“… Calendar
                    </button>
                    <button class="btn-premium btn-premium-sm btn-premium-outline" id="listViewBtn" onclick="switchReservationView('list')" style="border-radius: 0 8px 8px 0;">
                        ğŸ“‹ List
                    </button>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn-premium btn-premium-ghost btn-premium-sm" onclick="openImportModal()">ğŸ“¤ Import</button>
                    <button class="btn-premium btn-premium-ghost btn-premium-sm" onclick="exportCSV()">ğŸ“¥ Export</button>
                </div>
            </div>

            <!-- âœ¨ Kanban Board View (NEW APP-STORE QUALITY) -->
            <div id="reservationKanbanContainer" style="display: block; margin-bottom: 24px;">
                <div id="kanbanBoardContainer"></div>
            </div>

            <!-- âœ¨ Calendar View Container (PREMIUM FEATURE) -->
            <div id="reservationCalendarContainer" class="calendar-container" style="display: none; margin-bottom: 24px;">
                <div id="bookingCalendar"></div>
            </div>

            <!-- List View Container -->
            <div id="reservationListContainer" class="card">
                <div class="filters">
                    <div class="filter-item" style="flex: 1; max-width: 350px;">
                        <input type="text" id="searchReservations" placeholder="ğŸ” Search by guest, booking ID, phone, property..." onkeypress="if(event.key==='Enter') filterReservations()" style="width: 100%;">
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="filterReservations()" style="white-space: nowrap;">
                        ğŸ” Search
                    </button>
                    <div class="filter-item" style="max-width: 180px;">
                        <select id="statusFilter" onchange="filterReservations()">
                            <option value="">All Status</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="pending">Pending</option>
                            <option value="checked-in">Checked In</option>
                            <option value="checked-out">Checked Out</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                    <div class="filter-item" style="max-width: 180px;">
                        <select id="propertyFilter" onchange="filterReservations()">
                            <option value="">All Properties</option>
                        </select>
                    </div>
                    <div class="filter-item" style="max-width: 180px;">
                        <select id="bookingSourceFilter" onchange="filterReservations()">
                            <option value="">All Sources</option>
                            <option value="DIRECT">ğŸŸ¢ Direct</option>
                            <option value="AIRBNB">ğŸ”µ Airbnb</option>
                            <option value="AGODA/BOOKING.COM">ğŸŸ¡ Agoda/Booking.com</option>
                            <option value="MMT/GOIBIBO">ğŸŸ  MakeMyTrip/Goibibo</option>
                            <option value="OTHER">âšª Other</option>
                        </select>
                    </div>
                    <div class="filter-item" style="max-width: 180px;">
                        <select id="monthFilter" onchange="filterReservations()">
                            <option value="">All Months</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="clearFilters()">Clear</button>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox" id="selectAllCheckbox" onchange="toggleAllRows(this)">
                                </th>
                                <th>Booking ID</th>
                                <th>Property</th>
                                <th>Source</th>
                                <th>Guest</th>
                                <th>Check-in</th>
                                <th>Nights</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reservationsTableBody">
                            <tr><td colspan="10" class="text-center">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Payments View -->
        <div id="paymentsView" class="container hidden">
            <!-- âœ¨ Premium Header -->
            <div class="page-header animate-fade-in-down">
                <div>
                    <h2 class="page-title">ğŸ’° Payments</h2>
                    <p class="page-subtitle">Track and manage all payment transactions</p>
                </div>
                <div class="page-actions">
                    <button class="btn-premium btn-premium-outline btn-premium-sm" onclick="exportPaymentsCSV()">
                        ğŸ“¥ Export
                    </button>
                    <button class="btn-premium btn-premium-primary" onclick="openMultiPaymentModal()">
                        â• Add Payment
                    </button>
                </div>
            </div>

            <!-- âœ¨ Premium Stats Grid -->
            <div class="stats-grid animate-fade-in-up" id="paymentStatsGrid" style="margin-bottom: var(--space-8);">
                <!-- Stats will be populated by JavaScript -->
            </div>

            <!-- âœ¨ Payment Reminders (Premium Card) -->
            <div class="card-premium animate-fade-in-up animate-delay-1" id="paymentRemindersCard" style="display: none; margin-bottom: var(--space-6);">
                <div class="widget-header" onclick="togglePaymentReminders()" style="cursor: pointer; user-select: none;">
                    <h3 class="widget-title">âš ï¸ Payment Reminders <span id="paymentRemindersIcon">ğŸ”½</span></h3>
                    <span id="paymentRemindersCount" style="font-size: var(--text-sm); color: var(--neutral-500);"></span>
                </div>
                <div id="paymentRemindersList" style="display: block; padding: var(--space-4);">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>

            <!-- âœ¨ Payment Records (Premium Table) -->
            <div class="card-premium animate-fade-in-up animate-delay-2">
                <div class="widget-header">
                    <h3 class="widget-title">Payment Records</h3>
                </div>

                <!-- âœ¨ Premium Search & Filters -->
                <div style="padding: var(--space-4); border-bottom: 1px solid var(--neutral-200); display: flex; gap: var(--space-3); flex-wrap: wrap; align-items: center;">
                    <div class="search-premium" style="flex: 1; min-width: 250px;">
                        <span class="search-premium-icon">ğŸ”</span>
                        <input type="text" id="searchPayments" class="search-premium-input" placeholder="Search by guest, booking ID..." onkeypress="if(event.key==='Enter') filterPayments()">
                    </div>
                    <div class="select-premium" style="min-width: 180px;">
                        <select id="paymentPropertyFilter" onchange="filterPayments()" style="width: 100%; padding: var(--space-2) var(--space-3); border: 2px solid var(--neutral-300); border-radius: var(--radius-lg); font-size: var(--text-sm);">
                            <option value="">All Properties</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                    <div class="select-premium" style="min-width: 150px;">
                        <select id="paymentStatusFilter" onchange="filterPayments()" style="width: 100%; padding: var(--space-2) var(--space-3); border: 2px solid var(--neutral-300); border-radius: var(--radius-lg); font-size: var(--text-sm);">
                            <option value="">All Status</option>
                            <option value="paid">Paid</option>
                            <option value="pending">Pending</option>
                            <option value="partial">Partial</option>
                        </select>
                    </div>
                    <button class="btn-premium btn-premium-ghost btn-premium-sm" onclick="clearPaymentFilters()">
                        Clear
                    </button>
                </div>

                <div class="table-container">
                    <table class="table-premium">
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Guest</th>
                                <th>Property</th>
                                <th>Check-in</th>
                                <th>Total / Net</th>
                                <th>Paid</th>
                                <th>Balance</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="paymentsTableBody">
                            <tr><td colspan="9" class="text-center" style="padding: var(--space-8);">
                                <div class="empty-state-premium">
                                    <div class="empty-state-icon">ğŸ’°</div>
                                    <div class="empty-state-title">Loading payments...</div>
                                </div>
                            </td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Availability Calendar View -->
        <div id="availabilityView" class="container hidden">
            <h2 style="margin-bottom: 24px;">Property Availability Calendar</h2>
            
            <div class="card">
                <div class="filters" style="margin-bottom: 20px;">
                    <div class="filter-item">
                        <select id="calendarPropertyFilter" onchange="loadAvailabilityCalendar()">
                            <option value="">All Properties</option>
                        </select>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-secondary btn-sm" onclick="changeMonth(-1)">â† Prev</button>
                        <button class="btn btn-secondary btn-sm" onclick="changeMonth(1)">Next â†’</button>
                    </div>
                </div>

                <div id="calendarContainer" class="calendar-container">
                    <div class="calendar-header">
                        <h3 id="calendarMonthYear" style="margin: 0;"></h3>
                        <div style="display: flex; gap: 20px; font-size: 13px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 14px; height: 14px; background: white; border: 2px solid #e2e8f0; border-radius: 3px;"></div>
                                        <span>ğŸŸ¢ Available</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 14px; height: 14px; background: #fee2e2; border-left: 3px solid #dc2626; border-radius: 3px;"></div>
                                        <span>ğŸ”´ Direct Booking</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 14px; height: 14px; background: #fef3c7; border-left: 3px solid #f59e0b; border-radius: 3px;"></div>
                                        <span>ğŸŸ¡ OTA Blocked</span>
                                    </div>
                                </div>
                            </div>    
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                    <div id="calendarLegend" style="margin-top: 20px; padding: 16px; background: var(--background); border-radius: 6px;">
                        <div style="font-weight: 600; margin-bottom: 8px;">Today's Bookings:</div>
                        <div id="todayBookings" style="font-size: 13px; color: var(--text-secondary);">
                            No bookings for selected date
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Properties View -->
        <div id="propertiesView" class="container hidden">
            <!-- âœ¨ Premium Header -->
            <div class="page-header animate-fade-in-down">
                <div>
                    <h2 class="page-title">ğŸ  Properties</h2>
                    <p class="page-subtitle">Manage your property portfolio</p>
                </div>
                <div class="page-actions">
                    <button class="btn-premium btn-premium-primary" onclick="openPropertyModal()">
                        â• Add Property
                    </button>
                </div>
            </div>

            <!-- âœ¨ Premium Properties Grid -->
            <div id="propertiesGrid" class="card-grid animate-fade-in-up"></div>
        </div>
        <!-- Performance View -->
        <div id="performanceView" class="container hidden">
            <h2 style="margin-bottom: 24px;">ğŸ“Š Property Performance Analysis</h2>
            
        <!-- Filters -->
        <div class="card">
            <div class="filters" style="align-items: center; flex-wrap: wrap;">
                <div class="filter-item" style="flex: 1; min-width: 200px;">
                    <label style="margin-bottom: 4px;">Select Property</label>
                    <select id="performancePropertyFilter" onchange="loadPropertyPerformance()">
                        <option value="">ğŸ  All Properties</option>
                    </select>
                </div>
                
                <div class="filter-item" style="min-width: 180px;">
                    <label style="margin-bottom: 4px;">Time Period</label>
                    <select id="performanceDateRange" onchange="handleDateRangeChange()">
                        <option value="all_time">All Time</option>
                        <option value="last30">Last 30 Days</option>
                        <option value="last90">Last 90 Days</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
                
                <div class="filter-item" id="customDateRangeFields" style="display: none; min-width: 140px;">
                    <label style="margin-bottom: 4px;">From</label>
                    <input type="date" id="performanceStartDate" onchange="loadPropertyPerformance()">
                </div>
                
                <div class="filter-item" id="customDateRangeFieldsTo" style="display: none; min-width: 140px;">
                    <label style="margin-bottom: 4px;">To</label>
                    <input type="date" id="performanceEndDate" onchange="loadPropertyPerformance()">
                </div>
                
                <div class="filter-item" style="min-width: 160px;">
                    <label style="margin-bottom: 4px;">Filter by Month</label>
                    <select id="performanceMonthFilter" onchange="loadPropertyPerformance()">
                        <option value="">All Months</option>
                    </select>
                </div>
                
                <button class="btn btn-secondary btn-sm" onclick="exportPerformanceReport()" style="align-self: flex-end; margin-top: 20px;">
                    ğŸ“¥ Export
                </button>
            </div>
            
            <div id="filterSummary" style="margin-top: 12px; padding: 8px 12px; background: var(--background); border-radius: 6px; font-size: 13px; color: var(--text-secondary);">
                <!-- Will show active filters -->
            </div>
        </div>

            <!-- Key Metrics -->
            <div id="performanceMetrics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 24px;">
                <!-- Will be populated by JS -->
            </div>

            <!-- Payment Information -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’° Payment & Revenue Breakdown</h3>
                </div>
                <div id="performancePaymentInfo"></div>
            </div>

        <!-- Analytics Grid (2x2) -->
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 24px;">
            <!-- Payment Methods Distribution -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’³ Payment Methods</h3>
                </div>
                <div id="performancePaymentMethods"></div>
            </div>

            <!-- Top Properties by Revenue -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ† Top Properties</h3>
                </div>
                <div id="performanceTopProperties" style="max-height: 400px; overflow-y: auto;"></div>
            </div>

            <!-- Booking Type Breakdown -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸª Booking Types</h3>
                </div>
                <div id="performanceBookingTypes"></div>
            </div>

            <!-- Channel Performance -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“Š Booking Channels</h3>
                </div>
                <div id="performanceChannels" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>

            <!-- Monthly Trends -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“ˆ Monthly Performance Trend</h3>
                </div>
                <div id="performanceMonthlyTrend"></div>
            </div>

            <!-- Property Comparison (if multiple selected) -->
            <div class="card" id="performanceComparison" style="display: none;">
                <div class="card-header">
                    <h3 class="card-title">âš–ï¸ Property Comparison</h3>
                </div>
                <div id="performanceComparisonContent"></div>
            </div>
        </div>
        <!-- Team View -->
        <div id="teamView" class="container hidden">
            <div class="card-header">
                <h2>Team</h2>
                <button class="btn btn-primary" onclick="openTeamModal()">+ Add Member</button>
            </div>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="teamTableBody">
                        <tr><td colspan="5" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Meals Management View -->
        <div id="mealsView" class="container hidden">
            <div class="card-header">
                <h2>ğŸ½ï¸ Meal Management</h2>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-secondary" onclick="refreshMeals()">
                        ğŸ”„ Refresh
                    </button>
                </div>
            </div>

            <!-- Search and Filter Section -->
            <div class="card" style="margin-bottom: 20px;">
                <div style="display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
                    <input
                        type="text"
                        id="mealSearchInput"
                        placeholder="ğŸ” Search by booking ID or guest name..."
                        style="flex: 1; min-width: 200px; padding: 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px;"
                        oninput="searchMeals(this.value)"
                    >
                    <select id="mealStatusFilter" style="padding: 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px;" onchange="filterMealsByStatus(this.value)">
                        <option value="all">All Status</option>
                        <option value="pending">â³ Pending</option>
                        <option value="approved">âœ… Approved</option>
                        <option value="rejected">âŒ Rejected</option>
                    </select>
                </div>
            </div>

            <!-- Stats Summary -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 20px;">
                <div style="background: var(--warning-light); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: 700;" id="mealStatPending">0</div>
                    <div style="font-size: 12px; opacity: 0.9;">Pending Review</div>
                </div>
                <div style="background: var(--success); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: 700;" id="mealStatApproved">0</div>
                    <div style="font-size: 12px; opacity: 0.9;">Approved</div>
                </div>
                <div style="background: var(--danger); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: 700;" id="mealStatRejected">0</div>
                    <div style="font-size: 12px; opacity: 0.9;">Rejected</div>
                </div>
            </div>

            <!-- Meals List -->
            <div id="mealsList">
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    Loading meal preferences...
                </div>
            </div>
        </div>

        <!-- Guest Documents View -->
        <div id="guestDocumentsView" class="container hidden">
            <div class="card-header">
                <h2>ğŸ“‹ Guest ID Documents</h2>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-secondary" onclick="copyGuestPortalLink()" title="Copy guest portal link">
                        ğŸ”— Copy Guest Portal Link
                    </button>
                    <button class="btn btn-secondary" onclick="refreshGuestDocuments()">
                        ğŸ”„ Refresh
                    </button>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="card">
                <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px;">
                    <button class="filter-chip active" data-status="all" onclick="filterGuestDocuments('all')">
                        All Documents
                    </button>
                    <button class="filter-chip" data-status="pending" onclick="filterGuestDocuments('pending')">
                        â³ Pending Review
                    </button>
                    <button class="filter-chip" data-status="verified" onclick="filterGuestDocuments('verified')">
                        âœ… Verified
                    </button>
                    <button class="filter-chip" data-status="rejected" onclick="filterGuestDocuments('rejected')">
                        âŒ Rejected
                    </button>
                    <button class="filter-chip" data-status="incomplete" onclick="filterGuestDocuments('incomplete')">
                        âš ï¸ Incomplete
                    </button>
                </div>

                <!-- Search Bar -->
                <div style="margin-bottom: 20px;">
                    <input
                        type="text"
                        id="guestDocSearch"
                        placeholder="ğŸ” Search by booking ID, guest name, or phone..."
                        style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px;"
                        oninput="searchGuestDocuments(this.value)"
                    >
                </div>

                <!-- Stats Summary -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 20px;">
                    <div style="background: var(--warning-light); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700;" id="docStatPending">0</div>
                        <div style="font-size: 12px; opacity: 0.9;">Pending Review</div>
                    </div>
                    <div style="background: var(--success); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700;" id="docStatVerified">0</div>
                        <div style="font-size: 12px; opacity: 0.9;">Verified</div>
                    </div>
                    <div style="background: var(--danger); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700;" id="docStatRejected">0</div>
                        <div style="font-size: 12px; opacity: 0.9;">Rejected</div>
                    </div>
                    <div style="background: var(--secondary); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700;" id="docStatIncomplete">0</div>
                        <div style="font-size: 12px; opacity: 0.9;">Incomplete</div>
                    </div>
                </div>

                <!-- Documents List -->
                <div id="guestDocumentsList">
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        Loading documents...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reservation Modal -->
    <div id="reservationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="reservationModalTitle">New Reservation</h3>
                <button class="close-btn" onclick="closeReservationModal()">&times;</button>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Property *</label>
                    <select id="propertySelect" required onchange="calculateTaxes()">
                        <option value="">Select Property</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Booking Status *</label>
                    <select id="bookingStatus">
                        <option value="pending">Pending</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="checked-in">Checked In</option>
                        <option value="checked-out">Checked Out</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Booking Type *</label>
                    <select id="bookingType" required>
                        <option value="STAYCATION">ğŸ–ï¸ Staycation</option>
                        <option value="WEDDING">ğŸ’’ Wedding</option>
                        <option value="BIRTHDAY">ğŸ‚ Birthday Party</option>
                        <option value="CORPORATE_EVENT">ğŸ¢ Corporate Event</option>
                        <option value="CORPORATE_STAY">ğŸ’¼ Corporate Stay</option>
                        <option value="SHOOT">ğŸ“¸ Shoot</option>
                    </select>
                </div>
            
                <div class="form-group">
                    <label>Booking Source</label>
                    <select id="bookingSource" onchange="toggleReservationCodeField(); toggleOtaServiceFeeField();">
                        <option value="DIRECT">Direct</option>
                        <option value="AIRBNB">Airbnb</option>
                        <option value="AGODA/BOOKING.COM">Agoda/Booking.com</option>
                        <option value="MMT/GOIBIBO">MMT/Goibibo</option>
                        <option value="OTHER">Other</option>
                    </select>
                </div>
            </div>

            <div class="form-row" id="reservationCodeRow" style="display: none;">
                <div class="form-group">
                    <label>Reservation Code / OTA Booking ID *</label>
                    <input type="text" id="reservationCode" placeholder="Enter OTA booking code">
                    <small style="font-size: 12px; color: var(--text-secondary); display: block; margin-top: 4px;">
                        Enter the booking code from Airbnb, MMT, Agoda, etc.
                    </small>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Check-in Date *</label>
                    <input type="date" id="checkInDate" required onchange="calculateTaxes()">
                </div>
                <div class="form-group">
                    <label>Check-out Date *</label>
                    <input type="date" id="checkOutDate" required onchange="calculateTaxes()">
                </div>
                <!-- NEW: auto nights -->
                <div class="form-group">
                    <label>Nights (auto)</label>
                    <input type="number" id="nights" value="0" readonly style="background:#f1f5f9;">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Guest Name *</label>
                    <input type="text" id="guestName" required>
                </div>
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="guestPhone" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="guestEmail">
                </div>
                <div class="form-group">
                    <label>Travelling From</label>
                    <input type="text" id="guestCity">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Number of Rooms</label>
                    <input type="number" id="numberOfRooms" min="1" value="1">
                </div>

                <div class="form-group">
                    <label>Adults *</label>
                    <input type="number" id="adults" min="1" value="2" required>
                </div>
                <div class="form-group">
                    <label>Kids</label>
                    <input type="number" id="kids" min="0" value="0">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Stay Amount (â‚¹)</label>
                    <input type="number" id="stayAmount" min="0" step="0.01" value="0" oninput="calculateTaxes()">
                </div>
                <div class="form-group">
                    <label>Extra Guest Charges (â‚¹)</label>
                    <input type="number" id="extraGuestCharges" min="0" step="0.01" value="0" oninput="calculateTaxes()">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Meals/Chef (â‚¹)</label>
                    <input type="number" id="mealsChef" min="0" step="0.01" value="0" oninput="calculateTaxes()">
                </div>
                <div class="form-group">
                    <label>Bonfire/Other (â‚¹)</label>
                    <input type="number" id="bonfireOther" min="0" step="0.01" value="0" oninput="calculateTaxes()">
                </div>
            </div>
            <!-- OTA Service Fee Field -->
            <div class="form-group" id="otaServiceFeeGroup" style="display: none;">
                <label style="display: flex; align-items: center; gap: 8px;">
                    <span>ğŸ¢ OTA Service Fee / Commission (â‚¹)</span>
                    <span style="font-size: 11px; color: var(--text-secondary); font-weight: 400;">
                        (e.g., Airbnb 15%, MMT 20%)
                    </span>
                </label>
                <input type="number" id="otaServiceFee" min="0" step="0.01" value="0" placeholder="Enter OTA commission amount">
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px; padding: 8px; background: #fef3c7; border-radius: 6px;">
                    ğŸ’¡ <strong>Tip:</strong> Calculate based on OTA's commission rate. Amount deducted from gross revenue.
                </div>
            </div>

            <div class="form-row">
                    <div class="form-group">
                        <label>GST Status *</label>
                        <select id="gstStatus" onchange="calculateTaxes()">
                            <option value="gst">GST Applicable</option>
                            <option value="non_gst">Non-GST</option>
                        </select>
                    </div>
                <div class="form-group">
                    <label>Taxes (â‚¹) - Auto-calculated</label>
                    <input type="number" id="taxes" min="0" step="0.01" value="0" readonly style="background: #f1f5f9;">
                    <small style="font-size: 11px; color: var(--text-secondary); display: block; margin-top: 4px;">
                        5% for â‰¤â‚¹7500/night, 18% for >â‚¹7500/night
                    </small>
                </div>
                <div class="form-group">
                    <label>Damages (â‚¹)</label>
                    <input type="number" id="damages" min="0" step="0.01" value="0" oninput="calculateTaxes()">
                </div>
            </div>

            <div class="form-group">
                <label>Hostizzy Revenue (â‚¹)</label>
                <input type="number" id="hostizzyRevenue" min="0" step="0.01" value="0" readonly style="background: var(--background);">
                <small style="font-size: 12px; color: var(--text-secondary); display: block; margin-top: 4px;">
                    Auto-calculated based on property's revenue share %
                </small>
            </div>

            <input type="hidden" id="editReservationId">
            <button class="btn btn-primary" style="width: 100%; margin-top: 16px;" onclick="saveReservation()">
                Save Reservation
            </button>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Add Payment</h3>
            </div>
            
            <div style="background: var(--background); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span>Total Amount:</span>
                    <strong id="paymentTotalAmount">â‚¹0</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span>Paid So Far:</span>
                    <strong style="color: var(--success);" id="paymentPaidAmount">â‚¹0</strong>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Balance:</span>
                    <strong style="color: var(--danger);" id="paymentBalance">â‚¹0</strong>
                </div>
            </div>

            <div class="form-group">
                <label>Amount (â‚¹) *</label>
                <div style="display: flex; gap: 8px;">
                    <input type="number" id="paymentAmount" min="0" step="0.01" required style="flex: 1;">
                    <button type="button" class="btn btn-secondary" onclick="startVoicePayment()" title="Voice Input">
                        ğŸ¤
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label>Payment Date *</label>
                <input type="date" id="paymentDate" required>
            </div>

            <div class="form-group">
                <label>Payment Method *</label>
                <select id="paymentMethod" required onchange="toggleRecipientField()">
                    <option value="">Select Method</option>
                    <option value="cash">ğŸ’µ Cash</option>
                    <option value="upi">ğŸ“± UPI</option>
                    <option value="gateway">ğŸ’³ Gateway</option>
                    <option value="bank_transfer">ğŸ¦ Bank Transfer</option>
                </select>
            </div>

            <div class="form-group" id="paymentRecipientGroup" style="display: none;">
                <label>Payment Received By *</label>
                <select id="paymentRecipient" required>
                    <option value="">Select Recipient</option>
                    <option value="hostizzy">ğŸ¢ Hostizzy</option>
                    <option value="property_owner">ğŸ  Property Owner</option>
                </select>
            </div>

            <div class="form-group">
                <label>Reference/Transaction ID</label>
                <input type="text" id="paymentReference" placeholder="Optional">
            </div>

            <div class="form-group">
                <label>Notes</label>
                <textarea id="paymentNotes" rows="3" placeholder="Optional notes..."></textarea>
            </div>

            <input type="hidden" id="paymentBookingId">
            <input type="hidden" id="editPaymentId">
            
            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closePaymentModal()" style="flex: 1;">
                    Cancel
                </button>
                <button class="btn btn-secondary" onclick="switchToMultiPayment()" style="flex: 1;">
                    <i class="fas fa-layer-group"></i> Add Multiple
                </button>
                <button class="btn btn-primary" onclick="savePayment()" style="flex: 1;">
                    ğŸ’° Save Payment
                </button>
            </div>
        </div>
    </div>

    <!-- Multi-Payment Entry Modal -->
    <div id="multiPaymentModal" class="modal">
        <div class="modal-content multi-payment-modal">
            <div class="modal-header">
                <h3 class="modal-title">
                    ğŸ’° Add Multiple Payments
                    <span id="paymentEntryCount" class="entry-count"></span>
                </h3>
                <button class="close-btn" onclick="closeMultiPaymentModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="info-banner">
                    <div style="font-weight: 600; margin-bottom: 8px;">Quick Add Multiple Payments</div>
                    <div style="font-size: 13px; color: #64748b;">Add payments for multiple bookings at once. Click "+ Add Row" to add more entries.</div>
                </div>

                <!-- DESKTOP VIEW: Table Layout -->
                <div class="desktop-payment-table" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead style="position: sticky; top: 0; background: #f8fafc; z-index: 1;">
                            <tr>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 120px;">Booking ID</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 120px;">Guest</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 100px;">Amount (â‚¹)</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 120px;">Date</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 120px;">Method</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0; min-width: 120px;">Received By</th>
                                <th style="padding: 8px; text-align: center; border-bottom: 2px solid #e2e8f0; width: 60px;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="multiPaymentTableBody">
                            <!-- Desktop table rows -->
                        </tbody>
                    </table>
                </div>

                <!-- MOBILE VIEW: Card Layout -->
                <div class="mobile-payment-cards" id="multiPaymentCardsContainer">
                    <!-- Mobile cards -->
                </div>

                <!-- Add Row Button -->
                <button class="btn btn-secondary btn-sm add-payment-btn" onclick="addPaymentRow()">
                    â• <span class="desktop-text">Add Row</span><span class="mobile-text">Add Payment Entry</span>
                </button>

                <!-- Common Settings -->
                <div class="common-settings-box">
                    <div style="font-weight: 600; margin-bottom: 12px;">âš¡ Quick Fill (Optional)</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Default Payment Method</label>
                            <select id="multiPaymentMethod">
                                <option value="">Select Method</option>
                                <option value="cash">ğŸ’µ Cash</option>
                                <option value="upi">ğŸ“± UPI</option>
                                <option value="gateway">ğŸ’³ Gateway</option>
                                <option value="bank_transfer">ğŸ¦ Bank Transfer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Default Date</label>
                            <input type="date" id="multiPaymentDate">
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="applyCommonSettings()">
                        Apply to All <span class="desktop-text">Rows</span><span class="mobile-text">Entries</span>
                    </button>
                </div>

                <!-- Action Buttons -->
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeMultiPaymentModal()">
                        Cancel
                    </button>
                    <button class="btn btn-primary" onclick="saveMultiplePayments()">
                        ğŸ’¾ Save All Payments
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Payment Modal -->
    <div id="bulkPaymentModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ’° Bulk Payment Collection</h3>
                <button class="close-btn" onclick="closeBulkPaymentModal()">&times;</button>
            </div>

            <div style="background: var(--background); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                <div style="font-weight: 600; margin-bottom: 12px;">Selected Bookings: <span id="bulkPaymentCount">0</span></div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span>Total Due:</span>
                    <strong style="color: var(--danger);" id="bulkTotalDue">â‚¹0</strong>
                </div>
            </div>

            <div id="bulkPaymentList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
                <!-- Will be populated dynamically -->
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Payment Method *</label>
                    <select id="bulkPaymentMethod" required onchange="toggleBulkRecipientField()">
                        <option value="">Select Method</option>
                        <option value="cash">ğŸ’µ Cash</option>
                        <option value="upi">ğŸ“± UPI</option>
                        <option value="gateway">ğŸ’³ Gateway</option>
                        <option value="bank_transfer">ğŸ¦ Bank Transfer</option>
                    </select>
                </div>
                <div class="form-group" id="bulkPaymentRecipientGroup" style="display: none;">
                    <label>Payment Received By *</label>
                    <select id="bulkPaymentRecipient" required>
                        <option value="">Select Recipient</option>
                        <option value="hostizzy">ğŸ¢ Hostizzy</option>
                        <option value="property_owner">ğŸ  Property Owner</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>Payment Date *</label>
                <input type="date" id="bulkPaymentDate" required>
            </div>

            <div class="form-group">
                <label>Notes</label>
                <textarea id="bulkPaymentNotes" rows="2" placeholder="Optional notes for all payments..."></textarea>
            </div>

            <button class="btn btn-primary" style="width: 100%;" onclick="saveBulkPayments()">
                ğŸ’° Collect All Payments
            </button>
        </div>
    </div>

    <!-- Payment History Modal -->
    <div id="paymentHistoryModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">Payment History</h3>
                <button class="close-btn" onclick="closePaymentHistoryModal()">&times;</button>
            </div>
            
            <div style="background: var(--background); padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                    <div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Total Amount</div>
                        <div style="font-size: 20px; font-weight: 700;" id="historyTotalAmount">â‚¹0</div>
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Paid</div>
                        <div style="font-size: 20px; font-weight: 700; color: var(--success);" id="historyPaidAmount">â‚¹0</div>
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Balance</div>
                        <div style="font-size: 20px; font-weight: 700; color: var(--danger);" id="historyBalance">â‚¹0</div>
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Status</div>
                        <div style="font-size: 16px; font-weight: 700;" id="historyStatus">-</div>
                    </div>
                </div>
            </div>

            <div id="paymentHistoryList">
                <div class="text-center">No payments recorded yet</div>
            </div>
        </div>
    </div>


    <!-- Property Modal -->
    <div id="propertyModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Add Property</h3>
                <button class="close-btn" onclick="closePropertyModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Property Name *</label>
                <input type="text" id="propertyName" required>
            </div>
            <div class="form-group">
                <label>Location *</label>
                <input type="text" id="propertyLocation" required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Type</label>
                    <select id="propertyType">
                        <option value="villa">Villa</option>
                        <option value="apartment">Apartment</option>
                        <option value="homestay">Homestay</option>
                        <option value="resort">Resort</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Capacity</label>
                    <input type="number" id="propertyCapacity" min="1" value="4">
                </div>
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="saveProperty()">Save Property</button>
        </div>
    </div>

    <!-- Team Modal -->
    <div id="teamModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Add Team Member</h3>
                <button class="close-btn" onclick="closeTeamModal()">&times;</button>
            </div>
            <form onsubmit="saveTeamMember(); return false;">
                <div class="form-group">
                    <label>Name *</label>
                    <input type="text" id="teamMemberName" required autocomplete="name">
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="teamMemberEmail" required autocomplete="email">
                </div>
                <div class="form-group">
                    <label>Password *</label>
                    <input type="password" id="teamMemberPassword" required autocomplete="new-password">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="teamMemberRole">
                        <option value="admin">Admin</option>
                        <option value="manager">Manager</option>
                        <option value="staff">Staff</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Add Member</button>
            </form>
        </div>
    </div>

    <!-- Bulk Edit Modal -->
    <div id="bulkEditModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Bulk Edit <span id="bulkEditCount">0</span> Items</h3>
                <button class="close-btn" onclick="closeBulkEditModal()">&times;</button>
            </div>
            
            <div class="form-group">
                <label>What do you want to edit?</label>
                <select id="bulkEditField" onchange="updateBulkEditOptions()">
                    <option value="">Select Field</option>
                    <option value="status">Booking Status</option>
                    <option value="payment_status">Payment Status</option>
                </select>
            </div>

            <div class="form-group" id="bulkEditValueGroup" style="display: none;">
                <label id="bulkEditValueLabel">New Value</label>
                <select id="bulkEditValue">
                    <option value="">Select Value</option>
                </select>
            </div>

            <button class="btn btn-primary" style="width: 100%;" onclick="applyBulkEdit()">
                Apply Changes
            </button>
        </div>
    </div>

    <!-- Guest Document Review Modal -->
    <div id="guestDocumentModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">Review Guest Document</h3>
                <button class="close-btn" onclick="closeGuestDocumentModal()">&times;</button>
            </div>

            <div id="guestDocumentModalContent">
                <!-- Guest & Reservation Info -->
                <div style="background: var(--background); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Guest Name</div>
                            <div style="font-weight: 600;" id="modalGuestName">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Booking ID</div>
                            <div style="font-weight: 600;" id="modalBookingId">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Document Type</div>
                            <div style="font-weight: 600; text-transform: capitalize;" id="modalDocType">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Document Number</div>
                            <div style="font-weight: 600;" id="modalDocNumber">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Submitted</div>
                            <div style="font-weight: 600;" id="modalSubmittedAt">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Status</div>
                            <div style="font-weight: 600;" id="modalStatus">-</div>
                        </div>
                    </div>
                </div>

                <!-- Document Images -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 20px;">
                    <!-- Front Image -->
                    <div id="modalFrontImageContainer">
                        <div style="font-weight: 600; margin-bottom: 8px;">Front Side</div>
                        <img id="modalFrontImage" style="width: 100%; border-radius: 8px; cursor: pointer; border: 2px solid var(--border);" onclick="openImageFullscreen(this.src)" alt="Front">
                    </div>

                    <!-- Back Image -->
                    <div id="modalBackImageContainer" style="display: none;">
                        <div style="font-weight: 600; margin-bottom: 8px;">Back Side</div>
                        <img id="modalBackImage" style="width: 100%; border-radius: 8px; cursor: pointer; border: 2px solid var(--border);" onclick="openImageFullscreen(this.src)" alt="Back">
                    </div>

                    <!-- Selfie -->
                    <div id="modalSelfieContainer" style="display: none;">
                        <div style="font-weight: 600; margin-bottom: 8px;">Selfie</div>
                        <img id="modalSelfieImage" style="width: 100%; border-radius: 8px; cursor: pointer; border: 2px solid var(--border);" onclick="openImageFullscreen(this.src)" alt="Selfie">
                    </div>
                </div>

                <!-- Rejection Reason (if rejected) -->
                <div id="rejectionReasonSection" style="display: none; background: #fef2f2; border: 1px solid #fecaca; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="font-weight: 600; color: #dc2626; margin-bottom: 8px;">Rejection Reason</div>
                    <div id="rejectionReasonText" style="color: #991b1b;"></div>
                </div>

                <!-- Staff Notes -->
                <div class="form-group">
                    <label>Staff Notes (Optional)</label>
                    <textarea id="modalStaffNotes" rows="3" placeholder="Add any internal notes about this document..." style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px;"></textarea>
                </div>

                <!-- Actions -->
                <div id="modalActions" style="display: flex; gap: 12px; margin-top: 20px;">
                    <button class="btn btn-success" style="flex: 1;" onclick="approveDocument()">
                        âœ… Approve Document
                    </button>
                    <button class="btn btn-danger" style="flex: 1;" onclick="showRejectForm()">
                        âŒ Reject Document
                    </button>
                </div>

                <!-- Delete Button (Admin only) -->
                <div id="deleteButtonContainer" style="display: none; margin-top: 12px;">
                    <button class="btn btn-danger" style="width: 100%; background: #991b1b;" onclick="deleteDocument()">
                        ğŸ—‘ï¸ Delete Document (Admin Only)
                    </button>
                </div>

                <!-- Reject Form (hidden by default) -->
                <div id="rejectFormSection" style="display: none; margin-top: 20px;">
                    <div class="form-group">
                        <label>Rejection Reason *</label>
                        <select id="modalRejectionReason" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px;">
                            <option value="">Select reason...</option>
                            <option value="blurry">Image is too blurry</option>
                            <option value="incomplete">Incomplete document</option>
                            <option value="expired">Document expired</option>
                            <option value="mismatch">Name mismatch</option>
                            <option value="invalid">Invalid document</option>
                            <option value="other">Other (specify in notes)</option>
                        </select>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-secondary" style="flex: 1;" onclick="hideRejectForm()">Cancel</button>
                        <button class="btn btn-danger" style="flex: 1;" onclick="rejectDocument()">Confirm Rejection</button>
                    </div>
                </div>


                <!-- Already Verified Message -->
                <div id="verifiedMessage" style="display: none; text-align: center; padding: 20px; background: #f0fdf4; border: 1px solid #86efac; border-radius: 8px;">
                    <div style="font-size: 48px; margin-bottom: 12px;">âœ…</div>
                    <div style="font-weight: 600; color: #16a34a; margin-bottom: 4px;">Document Verified</div>
                    <div style="color: #15803d; font-size: 14px;">Verified by <span id="verifiedBy">-</span> on <span id="verifiedAt">-</span></div>
                    
                    <!-- Flip Switch to Reject -->
                    <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #86efac;">
                        <button class="btn btn-danger" style="width: 100%; background: #dc2626;" onclick="reverseApprovalToReject()">
                            ğŸ”„ Revert to Reject (Undo Approval)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Image Modal -->
    <div id="fullscreenImageModal" class="modal" onclick="closeFullscreenImage()">
        <div style="position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
            <button class="close-btn" style="position: absolute; top: 20px; right: 20px; background: white; z-index: 10;" onclick="closeFullscreenImage()">&times;</button>
            <img id="fullscreenImage" style="max-width: 90%; max-height: 90%; object-fit: contain; border-radius: 8px;" alt="Fullscreen view">
        </div>
    </div>

    <!-- CSV Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“¤ Import Reservations</h3>
                <button class="close-btn" onclick="closeImportModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <!-- Step 1: Upload -->
                <div id="importStep1" class="import-step">
                    <!-- Upload Area -->
                    <div style="border: 2px dashed #cbd5e1; border-radius: 12px; padding: 48px 24px; text-align: center; background: #f8fafc; cursor: pointer; transition: all 0.2s;" 
                         onclick="document.getElementById('csvFileInput').click()"
                         onmouseover="this.style.borderColor='#2563eb'; this.style.background='#eff6ff'"
                         onmouseout="this.style.borderColor='#cbd5e1'; this.style.background='#f8fafc'">
                        <div style="font-size: 40px; margin-bottom: 12px;">ğŸ“</div>
                        <div style="font-size: 16px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">
                            Drop CSV file here or click to browse
                        </div>
                        <div style="font-size: 13px; color: #64748b;">
                            Maximum file size: 10MB
                        </div>
                        <input type="file" id="csvFileInput" accept=".csv" style="display: none;" onchange="handleCSVUpload(event)">
                    </div>

                    <!-- Collapsible Format Guide -->
                    <div style="margin-top: 20px;">
                        <button onclick="toggleFormatGuide()" 
                                style="width: 100%; padding: 12px 16px; background: white; border: 1px solid var(--border); border-radius: 8px; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 14px; font-weight: 600;">
                            <span>ğŸ“‹ CSV Format Requirements</span>
                            <span id="formatGuideIcon">â–¼</span>
                        </button>
                        <div id="formatGuide" style="display: none; margin-top: 12px; padding: 16px; background: #fffbeb; border: 1px solid #fbbf24; border-radius: 8px; font-size: 13px; line-height: 1.7;">
                            <div style="margin-bottom: 12px;"><strong>Required columns:</strong></div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 4px; margin-bottom: 12px;">
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">booking_id</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">property_name</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">check_in</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">check_out</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">guest_name</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">guest_phone</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">status</code>
                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">total_amount</code>
                            </div>
                            <div style="font-size: 12px; color: #92400e;">
                                ğŸ’¡ Dates must be YYYY-MM-DD format â€¢ Amounts must be numbers only
                            </div>
                        </div>
                    </div>

                    <!-- Options -->
                    <div style="margin-top: 20px; display: flex; gap: 16px; padding: 16px; background: white; border: 1px solid var(--border); border-radius: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; flex: 1;">
                            <input type="checkbox" id="excludeFY2526" checked style="width: 18px; height: 18px;">
                            <span style="font-size: 14px;">Exclude FY 2025-26</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; flex: 1;">
                            <input type="checkbox" id="skipDuplicates" checked style="width: 18px; height: 18px;">
                            <span style="font-size: 14px;">Skip duplicates</span>
                        </label>
                    </div>
                </div>

                <!-- Step 2: Preview -->
                <div id="importStep2" class="import-step" style="display: none;">
                    <!-- Stats -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                        <div style="padding: 16px; background: #f8fafc; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700;" id="totalRows">0</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Total Rows</div>
                        </div>
                        <div style="padding: 16px; background: #f0fdf4; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--success);" id="validRows">0</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Will Import</div>
                        </div>
                        <div style="padding: 16px; background: #fef2f2; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--danger);" id="skippedRows">0</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Will Skip</div>
                        </div>
                    </div>

                    <!-- Preview Table -->
                    <div style="max-height: 280px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 16px;">
                        <table style="width: 100%; font-size: 12px;">
                            <thead style="position: sticky; top: 0; background: #f8fafc; z-index: 1;">
                                <tr>
                                    <th style="padding: 10px 8px; border-bottom: 2px solid var(--border); text-align: left; font-weight: 600;">Property</th>
                                    <th style="padding: 10px 8px; border-bottom: 2px solid var(--border); text-align: left; font-weight: 600;">Guest</th>
                                    <th style="padding: 10px 8px; border-bottom: 2px solid var(--border); text-align: left; font-weight: 600;">Check-in</th>
                                    <th style="padding: 10px 8px; border-bottom: 2px solid var(--border); text-align: left; font-weight: 600;">Status</th>
                                </tr>
                            </thead>
                            <tbody id="previewTableBody"></tbody>
                        </table>
                    </div>

                    <!-- Actions -->
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-secondary" onclick="resetImport()">â† Back</button>
                        <button class="btn btn-success" onclick="startImport()" style="flex: 1;" id="startImportBtn">
                            Import <span id="importCount">0</span> Reservations
                        </button>
                    </div>
                </div>

                <!-- Step 3: Progress -->
                <div id="importStep3" class="import-step" style="display: none;">
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; margin-bottom: 16px;">â³</div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 16px;">Importing...</div>
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">
                            <span id="importProgress">0</span> / <span id="importTotal">0</span> completed
                        </div>
                        <div style="background: #e2e8f0; border-radius: 8px; height: 8px; overflow: hidden;">
                            <div id="importProgressBar" style="background: var(--success); height: 100%; width: 0%; transition: width 0.3s;"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Complete -->
                <div id="importStep4" class="import-step" style="display: none;">
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 56px; margin-bottom: 16px;">âœ…</div>
                        <div style="font-size: 20px; font-weight: 600; margin-bottom: 8px;">Import Complete!</div>
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 24px;">
                            Successfully imported <span id="importedCount" style="color: var(--success); font-weight: 700;">0</span> reservations
                        </div>
                        <button class="btn btn-primary" onclick="closeImportModal()">Done</button>
                    </div>
                </div>
            </div>
        </div>
     </div>

    <!-- WhatsApp Modal -->
    <div id="whatsappModal" class="modal">
         <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“± Send WhatsApp Message</h3>
                <button class="close-btn" onclick="closeWhatsAppModal()">&times;</button>
            </div>
            
            <div style="padding: 24px;">
                <!-- Guest Info Card -->
                <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; color: white;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                        <div style="font-size: 32px;">ğŸ‘¤</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 18px; margin-bottom: 4px;" id="whatsappGuestName">Guest Name</div>
                            <div style="font-size: 14px; opacity: 0.9; display: flex; align-items: center; gap: 8px;">
                                <span>ğŸ“</span>
                                <span id="whatsappGuestPhone">Phone</span>
                            </div>
                        </div>
                    </div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 8px;">
                        ğŸ†” Booking: <span id="whatsappBookingId" style="font-weight: 600;">-</span>
                    </div>
                </div>
                
                <!-- Template Selection -->
                <div class="form-group">
                    <label>Select Message Template *</label>
                    <select id="whatsappTemplate" onchange="previewWhatsAppMessage()" style="font-size: 14px;">
                        <option value="booking_confirmation">âœ… Booking Confirmation - Full booking details</option>
                        <option value="payment_reminder">ğŸ’° Payment Reminder - Pending balance alert</option>
                        <option value="check_in_instructions">ğŸ  Check-in Instructions - Arrival details</option>
                        <option value="thank_you">ğŸ™ Thank You Message - Post-checkout feedback</option>
                        <option value="custom">ğŸ’¬ Custom Message - Write your own</option>
                    </select>
                </div>
                
                <!-- Custom Message (hidden by default) -->
                <div class="form-group" id="customMessageGroup" style="display: none;">
                    <label>Custom Message</label>
                    <textarea id="customMessageText" rows="6" placeholder="Type your message here..." oninput="previewWhatsAppMessage()"></textarea>
                </div>
                
                <!-- Message Preview -->
                <div style="background: #dcf8c6; padding: 16px; border-radius: 12px; margin-bottom: 20px; max-height: 350px; overflow-y: auto; position: relative;">
                    <div style="font-size: 11px; color: #128c7e; font-weight: 600; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                        ğŸ“± Message Preview
                    </div>
                    <div id="whatsappPreview" style="white-space: pre-wrap; font-size: 14px; line-height: 1.6; color: #303030;"></div>
                    <div style="position: absolute; top: 12px; right: 12px; background: white; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; font-size: 18px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        ğŸ’¬
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; margin-bottom: 24px;">
                    <button class="btn btn-secondary" onclick="closeWhatsAppModal()" style="flex: 1;">
                        Cancel
                    </button>
                    <button class="btn btn-success" onclick="confirmSendWhatsApp()" style="flex: 2; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <span style="font-size: 18px;">ğŸ“±</span>
                        <span>Open WhatsApp</span>
                    </button>
                </div>
                
                <!-- Communication History -->
                <div style="padding-top: 20px; border-top: 1px solid var(--border);">
                    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>ğŸ“œ</span>
                        <span>Communication History</span>
                    </h4>
                    <div id="communicationHistory" style="font-size: 13px; max-height: 200px; overflow-y: auto;">
                        <div style="color: var(--text-secondary); font-style: italic;">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div> 
 

<!-- Property Settings Modal -->
<div id="propertySettingsModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 24px; border-radius: 12px 12px 0 0;">
            <h2 style="margin: 0; font-size: 24px; display: flex; align-items: center; gap: 12px;">
                <span>âš™ï¸</span>
                <span id="settingsModalTitle">Property Settings</span>
            </h2>
            <button class="modal-close" onclick="closePropertySettings()" style="color: white; font-size: 28px;">&times;</button>
        </div>
        <div class="modal-body" style="padding: 32px;">
            <input type="hidden" id="settingsPropertyId">
            
            <!-- Property Info -->
            <div style="background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <span style="font-size: 24px;" id="settingsPropertyIcon">ğŸ </span>
                    <div>
                        <div style="font-weight: 600; font-size: 16px; color: #1e293b;" id="settingsPropertyName">Property Name</div>
                        <div style="font-size: 14px; color: #64748b;" id="settingsPropertyLocation">Location</div>
                    </div>
                </div>
            </div>

            <!-- iCal Sync Configuration -->
            <div style="margin-bottom: 24px;">
                <label style="display: block; font-weight: 600; color: #1e293b; margin-bottom: 8px; font-size: 14px;">
                    ğŸ“… iCal Sync URL (Airbnb/OTA)
                </label>
                <input type="url" id="icalUrlInput" placeholder="https://www.airbnb.com/calendar/ical/..." 
                    style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: all 0.3s;">
                <div style="margin-top: 8px; font-size: 13px; color: #64748b;">
                    ğŸ’¡ Paste your Airbnb or OTA calendar export link here to sync availability
                </div>
            </div>

            <!-- Current Sync Status -->
            <div id="currentSyncStatus" style="display: none; background: #f1f5f9; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                <div style="font-weight: 600; font-size: 13px; color: #475569; margin-bottom: 8px;">Current Status:</div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <span id="currentStatusBadge"></span>
                </div>
                <div style="font-size: 13px; color: #64748b;" id="currentLastSync"></div>
                <div id="currentSyncError" style="display: none; margin-top: 8px; padding: 12px; background: #fef2f2; border-left: 3px solid #ef4444; border-radius: 4px; font-size: 13px; color: #dc2626;"></div>
            </div>

            <!-- Auto-Sync Settings -->
            <div style="margin-bottom: 24px; padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                    <div>
                        <div style="font-weight: 600; color: #1e293b; margin-bottom: 4px;">ğŸ”„ Auto-Sync</div>
                        <div style="font-size: 13px; color: #64748b;">Automatically sync availability every 6 hours</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="autoSyncEnabled" onchange="toggleAutoSyncInfo()">
                        <span class="slider"></span>
                    </label>
                </div>
                <div id="autoSyncInfo" style="display: none; font-size: 12px; color: #64748b; padding: 8px; background: #fff; border-radius: 4px;">
                    â° Next sync: <span id="nextSyncTime">-</span>
                </div>
            </div>

            <!-- How to Get iCal URL -->
            <details style="margin-bottom: 24px; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px;">
                <summary style="cursor: pointer; font-weight: 600; color: #475569; font-size: 14px;">
                    â„¹ï¸ How to get iCal URL from Airbnb/OTAs
                </summary>
                <div style="margin-top: 12px; font-size: 13px; color: #64748b; line-height: 1.6;">
                    <strong style="color: #1e293b;">Airbnb:</strong><br>
                    Go to Listing â†’ Availability â†’ Export Calendar â†’ Copy iCal Link<br><br>
                    <strong style="color: #1e293b;">Booking.com:</strong><br>
                    Extranet â†’ Calendar â†’ Sync Calendar â†’ Copy iCal URL<br><br>
                    <strong style="color: #1e293b;">Other OTAs:</strong><br>
                    Look for "Calendar Export", "iCal Sync", or "Calendar URL" in settings
                </div>
            </details>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <button onclick="closePropertySettings()" 
                    style="padding: 12px 24px; background: #f1f5f9; color: #475569; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                    Cancel
                </button>
                <button onclick="savePropertySettings()" 
                    style="padding: 12px 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);">
                    ğŸ’¾ Save Settings
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Guest Detail Modal -->
    <div id="guestDetailModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="guestDetailName">Guest Profile</h2>
                <button class="close-modal" onclick="closeGuestDetailModal()">Ã—</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <!-- Guest Profile Card -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 16px;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px;">
                                    ğŸ‘¤
                                </div>
                                <div>
                                    <h2 style="margin: 0; font-size: 24px;" id="guestDetailNameHeader">Guest Name</h2>
                                    <div id="guestDetailBadge" style="display: inline-block; padding: 4px 12px; background: rgba(255,255,255,0.2); border-radius: 12px; font-size: 12px; margin-top: 4px;">
                                        New Guest
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 8px; font-size: 14px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span>ğŸ“±</span>
                                    <span id="guestDetailPhone">+91-XXXXXXXXXX</span>
                                    <button onclick="callGuest()" style="background: rgba(255,255,255,0.2); border: none; padding: 4px 12px; border-radius: 6px; color: white; cursor: pointer; font-size: 12px;">
                                        Call
                                    </button>
                                    <button onclick="whatsappGuest()" style="background: rgba(37,211,102,0.8); border: none; padding: 4px 12px; border-radius: 6px; color: white; cursor: pointer; font-size: 12px;">
                                        WhatsApp
                                    </button>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span>ğŸ“§</span>
                                    <span id="guestDetailEmail">email@example.com</span>
                                    <button onclick="emailGuest()" style="background: rgba(255,255,255,0.2); border: none; padding: 4px 12px; border-radius: 6px; color: white; cursor: pointer; font-size: 12px;">
                                        Email
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button class="btn" onclick="editGuestInfo()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);">
                            âœï¸ Edit Info
                        </button>
                    </div>
                </div>

                <!-- Guest Statistics -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 24px;">
                    <div style="background: var(--background-alt); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary);" id="guestDetailTotalBookings">0</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Total Bookings</div>
                    </div>
                    <div style="background: var(--background-alt); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--success);" id="guestDetailTotalNights">0</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Total Nights</div>
                    </div>
                    <div style="background: var(--background-alt); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--warning);" id="guestDetailTotalSpent">â‚¹0</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Total Spent</div>
                    </div>
                    <div style="background: var(--background-alt); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: #06b6d4;" id="guestDetailAvgValue">â‚¹0</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Avg Booking Value</div>
                    </div>
                    <div style="background: var(--background-alt); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--text-secondary);" id="guestDetailLastVisit">Never</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Last Visit</div>
                    </div>
                </div>

                <!-- Booking History -->
                <div>
                    <h3 style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                        ğŸ“… Booking History
                        <span id="guestDetailBookingCount" style="background: var(--primary); color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">0</span>
                    </h3>
                    <div id="guestDetailBookingHistory" style="display: flex; flex-direction: column; gap: 12px;">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="editGuestModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>âœï¸ Edit Guest Information</h2>
                <button class="close-modal" onclick="closeEditGuestModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editGuestOriginalPhone">
                <input type="hidden" id="editGuestOriginalEmail">
                
                <div class="form-group">
                    <label>Guest Name *</label>
                    <input type="text" id="editGuestName" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="editGuestPhone" required placeholder="+91-XXXXXXXXXX">
                </div>
                
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="editGuestEmail" placeholder="guest@example.com">
                </div>
                
                <div style="margin-top: 16px; padding: 12px; background: #fef3c7; border-radius: 8px; font-size: 13px; color: #92400e;">
                    âš ï¸ Note: This will update guest information for all their bookings.
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditGuestModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveGuestInfo()">ğŸ’¾ Save Changes</button>
            </div>
        </div>
    </div>
    <div id="keyboardShortcutsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>âŒ¨ï¸ Keyboard Shortcuts</h2>
                <button class="close-modal" onclick="closeKeyboardShortcuts()">Ã—</button>
            </div>
            <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
                <div style="display: grid; gap: 20px;">
                    <div>
                        <h3 style="color: var(--primary); margin-bottom: 12px;">Navigation</h3>
                        <div style="display: grid; gap: 8px;">
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Home View</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 1</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Dashboard</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 2</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Reservations</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 3</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Payments</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 4</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Availability</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 5</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Properties</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 6</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Performance</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 7</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Team</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Alt + 8</kbd>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="color: var(--primary); margin-bottom: 12px;">Actions</h3>
                        <div style="display: grid; gap: 8px;">
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Quick Actions</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Ctrl/Cmd + K</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Save Form</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Ctrl/Cmd + S</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Close Modal</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">Esc</kbd>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8fafc; border-radius: 6px;">
                                <span>Show Shortcuts</span>
                                <kbd style="background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">?</kbd>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="pwaInstallBanner" style="display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; padding: 16px 24px; border-radius: 16px; box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4); z-index: 9999; max-width: 90%; width: 400px; animation: slideUp 0.4s ease-out;">
        <div style="display: flex; align-items: center; gap: 16px;">
            <div style="font-size: 32px;">ğŸ“±</div>
            <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 4px;">Install ResIQ</div>
                <div style="font-size: 13px; opacity: 0.9;">Get the app experience with offline access</div>
            </div>
            <button onclick="installPWA()" style="background: white; color: #6366f1; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px; white-space: nowrap;">
                Install
            </button>
            <button onclick="dismissInstallBanner()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 8px; border-radius: 8px; cursor: pointer; font-size: 18px; line-height: 1; width: 32px; height: 32px;">
                Ã—
            </button>
        </div>
    </div>
    <div id="quickActionsOverlay" class="quick-actions-overlay" onclick="closeQuickActions(event)">
        <div class="quick-actions-panel" onclick="event.stopPropagation()">
            <div class="quick-actions-search">
                <input type="text" id="quickActionsSearch" placeholder="Type a command or search..." autocomplete="off" onkeyup="filterQuickActions(event)">
                <button class="quick-actions-voice-btn" onclick="startVoiceCommand()" id="voiceCommandBtn" title="Voice Commands">
                    ğŸ¤
                </button>
            </div>
            
            <div class="quick-actions-list" id="quickActionsList">
                <!-- Will be populated by JavaScript -->
            </div>
            
            <div class="quick-actions-footer">
                <div>
                    <kbd>â†‘</kbd> <kbd>â†“</kbd> to navigate â€¢ <kbd>Enter</kbd> to select
                </div>
                <div>
                    <kbd>Esc</kbd> to close
                </div>
            </div>
        </div>
    </div>
    <div id="splashScreen" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        transition: opacity 0.5s ease-out;
        overflow: hidden;
    ">
        
        <!-- Animated background particles -->
        <div style="position: absolute; inset: 0; background: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%), radial-gradient(circle at 80% 30%, rgba(255,255,255,0.08) 0%, transparent 50%);"></div>
        
        <div style="text-align: center; animation: fadeInUp 0.8s ease-out; position: relative; z-index: 1;">
            <div style="
                width: 160px;
                height: 160px;
                background: rgba(255, 255, 255, 0.15);
                backdrop-filter: blur(20px);
                border-radius: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 40px;
                animation: scaleIn 0.6s ease-out, pulseGlow 2s ease-in-out infinite;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                border: 3px solid rgba(255, 255, 255, 0.2);
            ">
                <!-- Replace with your actual logo -->
                <img src="assets/logo.png" alt="ResIQ Logo" style="width: 100px; height: 100px; object-fit: contain;" 
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <!-- Fallback if logo doesn't load -->
               <div style="display: none; font-size: 64px; font-weight: 800; background: linear-gradient(135deg, #6366f1, #ec4899); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">R</div>
            </div>
            
            <h1 style="
                color: white;
                font-size: 52px;
                font-weight: 800;
                margin-bottom: 12px;
                letter-spacing: -1px;
                animation: fadeInUp 0.8s ease-out 0.2s both;
                text-shadow: 0 4px 20px rgba(0,0,0,0.2);
            ">ResIQ</h1>
            
            <p style="
                color: rgba(255,255,255,0.95);
                font-size: 20px;
                font-weight: 600;
                animation: fadeInUp 0.8s ease-out 0.4s both;
                letter-spacing: 2px;
                text-transform: uppercase;
            ">by Hostizzy</p>
            
            <div style="
                margin-top: 56px;
                animation: fadeInUp 0.8s ease-out 0.6s both;
            ">
                <div style="
                    width: 40px;
                    height: 40px;
                    border: 3px solid rgba(255,255,255,0.3);
                    border-top-color: white;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                    margin: 0 auto;
                "></div>
            </div>
        </div>
        
        <style>
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
        </style>
    </div>


    <!-- Bulk Actions Bar -->
    <div id="bulkActionsBar" class="bulk-actions-bar">
        <span class="bulk-count"><span id="bulkSelectedCount">0</span> selected</span>
        <button class="btn btn-primary btn-sm" onclick="openBulkEditModal()">âœï¸ Edit Status</button>
        <button class="btn btn-secondary btn-sm" onclick="clearBulkSelection()">âœ–ï¸ Clear</button>
    </div>


    <!-- Vite will inject the bundled script here -->
    <script type="module" src="/src/main.js"></script>

    <!-- Hide splash screen after app loads -->
    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                const splash = document.getElementById('splashScreen');
                if (splash) {
                    splash.style.opacity = '0';
                    setTimeout(() => {
                        splash.style.display = 'none';
                    }, 500);
                }
            }, 1000);
        });
    </script>
</body>
</html>
